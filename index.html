<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار القدرات اللفظي - النموذج 20</title>
    <style>
        :root { --primary-color: #27ae60; --secondary-color: #e67e22; --bg-color: #f0f9f4; --white: #ffffff; --correct-bg: #d4edda; --wrong-bg: #f8d7da; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-color); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .quiz-card { background: var(--white); width: 95%; max-width: 850px; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-top: 8px solid var(--primary-color); text-align: center; }
        .header-info { margin-bottom: 25px; border-bottom: 2px solid #eee; padding-bottom: 15px; }
        
        /* ميزة المتحدي الجديدة */
        .challenger-badge { background: var(--secondary-color); color: white; padding: 8px 20px; border-radius: 30px; font-weight: bold; display: inline-block; margin-bottom: 20px; font-size: 1.2rem; box-shadow: 0 4px 15px rgba(230, 126, 34, 0.3); }
        
        input[type="text"] { width: 80%; padding: 12px; border: 2px solid #ddd; border-radius: 10px; font-size: 1.1rem; margin: 20px 0; outline: none; text-align: center; }
        .btn { background: var(--primary-color); color: white; padding: 12px 30px; border: none; border-radius: 10px; font-size: 1.1rem; cursor: pointer; transition: 0.3s; margin: 5px; }
        .btn:hover { background: #219150; }
        .timer-bar { height: 10px; background: #eee; border-radius: 5px; margin: 20px 0; overflow: hidden; }
        .timer-progress { height: 100%; background: #e74c3c; width: 100%; transition: width 1s linear; }
        .options-container { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 25px; }
        .option { padding: 15px; border: 2px solid #f1f2f6; border-radius: 12px; cursor: pointer; font-weight: 500; transition: 0.2s; text-align: center; }
        .correct-opt { background: #dff9fb !important; border-color: #2ecc71 !important; color: #27ae60; }
        .wrong-opt { background: #ffeaa7 !important; border-color: #e74c3c !important; color: #c0392b; }
        .feedback { margin-top: 20px; padding: 20px; border-radius: 12px; display: none; background: #f8f9fa; text-align: right; border-right: 5px solid var(--primary-color); line-height: 1.6; }
        .summary-item { padding: 15px; border-bottom: 1px solid #eee; margin-bottom: 10px; border-radius: 8px; text-align: right; }
        .summary-correct { background-color: var(--correct-bg); border-right: 5px solid #28a745; }
        .summary-wrong { background-color: var(--wrong-bg); border-right: 5px solid #dc3545; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="quiz-card">
    <div class="header-info">
        <div style="font-weight: bold; color: var(--primary-color);">ثانوية الأمير عبدالمجيد</div>
        <div style="color: #7f8c8d;">أ / عبدالعزيز الفيفي</div>
        <h1>اختبار القدرات - النموذج 20</h1>
    </div>

    <div id="start-page">
        <p>مرحباً بك في تحدي التناظر اللفظي (النموذج 20)</p>
        <input type="text" id="studentName" placeholder="اكتب اسمك هنا لبدء التحدي...">
        <br>
        <button class="btn" onclick="startQuiz()">ابدأ التحدي</button>
    </div>

    <div id="quiz-page" class="hidden">
        <div class="challenger-badge">المتحدي: <span id="display-name"></span></div>
        <div style="display: flex; justify-content: space-between;">
            <span>السؤال: <b id="q-num">1</b> / 38</span>
            <span style="color: #e74c3c;">الوقت: <b id="timer-text">45</b> ث</span>
        </div>
        <div class="timer-bar"><div id="timer-line" class="timer-progress"></div></div>
        <h2 id="question-text"></h2>
        <div class="options-container" id="options"></div>
        <div id="feedback" class="feedback"></div>
        <button id="next-btn" class="btn hidden" onclick="loadNextQuestion()" style="margin-top: 20px;">السؤال التالي</button>
    </div>

    <div id="result-page" class="hidden">
        <h2 id="score-text"></h2>
        <div id="quiz-summary"></div>
        <button class="btn" onclick="location.reload()">إعادة الاختبار</button>
    </div>
</div>

<script>
    const masterQuestions = [
        { q: "حجرة : منزل", correct: "حرف : كلمة", a: ["حرف : كلمة", "غرفة : فندق", "شجرة : غابة", "شارع : مدينة"], why: "العلاقة (جزء من كل): الحجرة جزء من المنزل والحرف جزء من الكلمة." },
        { q: "حرف : كلمة", correct: "شجرة : غابة", a: ["شجرة : غابة", "حجرة : منزل", "طاولة : فصل", "ورقة : دفتر"], why: "العلاقة (جزء من كل): الحرف جزء من الكلمة والشجرة جزء من الغابة." },
        { q: "شجرة : غابة", correct: "غرفة : فندق", a: ["غرفة : فندق", "شارع : مدينة", "ثلاجة : مطبخ", "حرف : كلمة"], why: "العلاقة (جزء من كل): الشجرة في الغابة والغرفة في الفندق." },
        { q: "غرفة : فندق", correct: "حجرة : منزل", a: ["حجرة : منزل", "طاولة : فصل", "ورقة : دفتر", "شجرة : غابة"], why: "العلاقة (جزء من كل): الغرفة جزء من الفندق والحجرة جزء من المنزل." },
        { q: "شارع : مدينة", correct: "طاولة : فصل", a: ["طاولة : فصل", "حجرة : منزل", "حرف : كلمة", "ثلاجة : مطبخ"], why: "العلاقة (جزء من كل): الشارع جزء من المدينة والطاولة جزء من الفصل." },
        { q: "طاولة : فصل", correct: "ثلاجة : مطبخ", a: ["ثلاجة : مطبخ", "ورقة : دفتر", "شارع : مدينة", "غرفة : فندق"], why: "العلاقة (جزء من كل): الطاولة في الفصل والثلاجة في المطبخ." },
        { q: "ثلاجة : مطبخ", correct: "ورقة : دفتر", a: ["ورقة : دفتر", "طاولة : فصل", "شارع : مدينة", "حجرة : منزل"], why: "العلاقة (جزء من كل): الثلاجة جزء من المطبخ والورقة جزء من الدفتر." },
        { q: "ورقة : دفتر", correct: "حرف : كلمة", a: ["حرف : كلمة", "شجرة : غابة", "شارع : مدينة", "ثلاجة : مطبخ"], why: "العلاقة (جزء من كل): الورقة جزء من الدفتر والحرف جزء من الكلمة." },
        { q: "منزل : غرفة", correct: "جملة : كلمة", a: ["جملة : كلمة", "مدينة : شارع", "جامعة : كلية", "كتاب : صفحة"], why: "العلاقة (كل وجزء): المنزل يحتوي غرفة والجملة تحتوي كلمة." },
        { q: "جملة : كلمة", correct: "مدينة : شارع", a: ["مدينة : شارع", "فصل : طاولة", "تلفزيون : شاشة", "عمارة : شقة"], why: "العلاقة (كل وجزء): الجملة تتكون من كلمات والمدينة تتكون من شوارع." },
        { q: "مدينة : شارع", correct: "جامعة : كلية", a: ["جامعة : كلية", "كتاب : صفحة", "تلفزيون : شاشة", "عمارة : شقة"], why: "العلاقة (كل وجزء): المدينة تضم شوارع والجامعة تضم كليات." },
        { q: "جامعة : كلية", correct: "منزل : غرفة", a: ["منزل : غرفة", "فصل : طاولة", "كتاب : صفحة", "تلفزيون : شاشة"], why: "العلاقة (كل وجزء): الجامعة تتكون من كليات والمنزل يتكون من غرف." },
        { q: "فصل : طاولة", correct: "كتاب : صفحة", a: ["كتاب : صفحة", "تلفزيون : شاشة", "عمارة : شقة", "مدينة : شارع"], why: "العلاقة (كل وجزء): الفصل فيه طاولات والكتاب فيه صفحات." },
        { q: "كتاب : صفحة", correct: "تلفزيون : شاشة", a: ["تلفزيون : شاشة", "عمارة : شقة", "فصل : طاولة", "جملة : كلمة"], why: "العلاقة (كل وجزء): الكتاب يحتوي صفحات والتلفاز يحتوي شاشة." },
        { q: "تلفزيون : شاشة", correct: "عمارة : شقة", a: ["عمارة : شقة", "منزل : غرفة", "جامعة : كلية", "مدينة : شارع"], why: "العلاقة (كل وجزء): الشاشة جزء من التلفاز والشقة جزء من العمارة." },
        { q: "عمارة : شقة", correct: "كتاب : صفحة", a: ["كتاب : صفحة", "فصل : طاولة", "جملة : كلمة", "تلفزيون : شاشة"], why: "العلاقة (كل وجزء): العمارة تتكون من شقق والكتاب يتكون من صفحات." },
        { q: "جراثيم : أمراض", correct: "أمانة : ربح", a: ["أمانة : ربح", "كسل : فشل", "تقوى : نجاة", "ركض : تعب"], why: "العلاقة (سبب ونتيجة): الجراثيم تسبب الأمراض والأمانة تسبب الربح." },
        { q: "أمانة : ربح", correct: "كسل : فشل", a: ["كسل : فشل", "تقوى : نجاة", "غرق : اختناق", "تفكير : إبداع"], why: "العلاقة (سبب ونتيجة): الأمانة تؤدي للربح والكسل يؤدي للفشل." },
        { q: "كسل : فشل", correct: "تقوى : نجاة", a: ["تقوى : نجاة", "تفكير : إبداع", "ركض : تعب", "اللقاح : المناعة"], why: "العلاقة (سبب ونتيجة): الكسل يسبب الفشل والتقوى تسبب النجاة." },
        { q: "تقوى : نجاة", correct: "جراثيم : أمراض", a: ["جراثيم : أمراض", "غرق : اختناق", "ركض : تعب", "تفكير : إبداع"], why: "العلاقة (سبب ونتيجة): التقوى سبب للنجاة والجراثيم سبب للمرض." },
        { q: "غرق : اختناق", correct: "ركض : تعب", a: ["ركض : تعب", "اللقاح : المناعة", "تفكير : إبداع", "أمانة : ربح"], why: "العلاقة (سبب ونتيجة): الغرق يؤدي للاختناق والركض يؤدي للتعب." },
        { q: "ركض : تعب", correct: "اللقاح : المناعة", a: ["اللقاح : المناعة", "تفكير : إبداع", "غرق : اختناق", "كسل : فشل"], why: "العلاقة (سبب ونتيجة): الركض يسبب التعب واللقاح يسبب المناعة." },
        { q: "اللقاح : المناعة", correct: "تفكير : إبداع", a: ["تفكير : إبداع", "تقوى : نجاة", "أمانة : ربح", "غرق : اختناق"], why: "العلاقة (سبب ونتيجة): اللقاح ينتج مناعة والتفكير ينتج إبداعاً." },
        { q: "تفكير : إبداع", correct: "ركض : تعب", a: ["ركض : تعب", "اللقاح : المناعة", "جراثيم : أمراض", "أمانة : ربح"], why: "العلاقة (سبب ونتيجة): التفكير يسبب الإبداع والركض يسبب التعب." },
        { q: "سرطان : تدخين", correct: "نجاة : تقوى", a: ["نجاة : تقوى", "سلامة : تأني", "ندامة : عجلة", "تقدم : علم"], why: "العلاقة (نتيجة وسبب): السرطان ناتج عن التدخين والنجاة ناتجة عن التقوى." },
        { q: "نجاة : تقوى", correct: "سلامة : تأني", a: ["سلامة : تأني", "ندامة : عجلة", "إبداع : تفكير", "تفوق : اجتهاد"], why: "العلاقة (نتيجة وسبب): النجاة تأتي من التقوى والسلامة تأتي من التأني." },
        { q: "سلامة : تأني", correct: "ندامة : عجلة", a: ["ندامة : عجلة", "تقدم : علم", "إبداع : تفكير", "مناعة : تطعيم"], why: "العلاقة (نتيجة وسبب): السلامة سببها التأني والندامة سببها العجلة." },
        { q: "ندامة : عجلة", correct: "سرطان : تدخين", a: ["سرطان : تدخين", "تقدم : علم", "إبداع : تفكير", "تفوق : اجتهاد"], why: "العلاقة (نتيجة وسبب): الندامة نتيجة العجلة والسرطان نتيجة التدخين." },
        { q: "تقدم : علم", correct: "إبداع : تفكير", a: ["إبداع : تفكير", "تفوق : اجتهاد", "مناعة : تطعيم", "سلامة : تأني"], why: "العلاقة (نتيجة وسبب): التقدم ناتج عن العلم والإبداع ناتج عن التفكير." },
        { q: "إبداع : تفكير", correct: "تفوق : اجتهاد", a: ["تفوق : اجتهاد", "مناعة : تطعيم", "سرطان : تدخين", "نجاة : تقوى"], why: "العلاقة (نتيجة وسبب): الإبداع سببه التفكير والتفوق سببه الاجتهاد." },
        { q: "تفوق : اجتهاد", correct: "مناعة : تطعيم", a: ["مناعة : تطعيم", "تقدم : علم", "إبداع : تفكير", "ندامة : عجلة"], why: "العلاقة (نتيجة وسبب): التفوق ناتج عن الاجتهاد والمناعة ناتجة عن التطعيم." },
        { q: "مناعة : تطعيم", correct: "تقدم : علم", a: ["تقدم : علم", "إبداع : تفكير", "سلامة : تأني", "نجاة : تقوى"], why: "العلاقة (نتيجة وسبب): المناعة تأتي من التطعيم والتقدم يأتي من العلم." },
        { q: "تحقق : تثبت", correct: "لجين : فضة", a: ["لجين : فضة", "عطاء : بذل", "منحة : عطية", "عبرة : دمعة"], why: "العلاقة (ترادف): تحقق بمعنى تثبت، ولجين هو اسم من أسماء الفضة." },
        { q: "لجين : فضة", correct: "عطاء : بذل", a: ["عطاء : بذل", "منحة : عطية", "عبرة : دمعة", "موئل : ملجأ"], why: "العلاقة (ترادف): لجين هي الفضة، والعطاء هو البذل." },
        { q: "عطاء : بذل", correct: "منحة : عطية", a: ["منحة : عطية", "عبرة : دمعة", "موئل : ملجأ", "تحقق : تثبت"], why: "العلاقة (ترادف): العطاء هو البذل والمنحة هي العطية." },
        { q: "منحة : عطية", correct: "تحقق : تثبت", a: ["تحقق : تثبت", "لجين : فضة", "عبرة : دمعة", "موئل : ملجأ"], why: "العلاقة (ترادف): المنحة هي العطية والتحقق هو التثبت." },
        { q: "عبرة : دمعة", correct: "موئل : ملجأ", a: ["موئل : ملجأ", "منحة : عطية", "عطاء : بذل", "لجين : فضة"], why: "العلاقة (ترادف): العبرة هي الدمعة والموئل هو الملجأ." },
        { q: "موئل : ملجأ", correct: "عبرة : دمعة", a: ["عبرة : دمعة", "عطاء : بذل", "تحقق : تثبت", "منحة : عطية"], why: "العلاقة (ترادف): الموئل يعني الملجأ والعبرة تعني الدمعة." }
    ];

    let questions = []; let currentQ = 0; let score = 0; let timer; let timeLeft = 45; let userAnswers = [];

    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function startQuiz() {
        const nameInput = document.getElementById('studentName');
        const name = nameInput.value.trim();
        if(!name) { alert("من فضلك اكتب اسمك"); return; }
        
        // إظهار اسم المتحدي
        document.getElementById('display-name').innerText = name;
        
        questions = shuffle([...masterQuestions]);
        document.getElementById('start-page').classList.add('hidden');
        document.getElementById('quiz-page').classList.remove('hidden');
        loadQuestion();
    }

    function loadQuestion() {
        if(currentQ >= questions.length) { finishQuiz(); return; }
        const qData = questions[currentQ];
        const shuffledOptions = shuffle([...qData.a]);
        document.getElementById('q-num').innerText = currentQ + 1;
        document.getElementById('question-text').innerText = qData.q;
        document.getElementById('feedback').style.display = 'none';
        document.getElementById('next-btn').classList.add('hidden');
        const optDiv = document.getElementById('options');
        optDiv.innerHTML = '';
        shuffledOptions.forEach(opt => {
            const d = document.createElement('div');
            d.className = 'option'; d.innerText = opt;
            d.onclick = () => checkAnswer(opt, d);
            optDiv.appendChild(d);
        });
        startTimer();
    }

    function startTimer() {
        clearInterval(timer); timeLeft = 45;
        const line = document.getElementById('timer-line');
        const txt = document.getElementById('timer-text');
        timer = setInterval(() => {
            timeLeft--; txt.innerText = timeLeft;
            line.style.width = (timeLeft/45)*100 + '%';
            if(timeLeft <= 0) { clearInterval(timer); checkAnswer(null, null); }
        }, 1000);
    }

    function checkAnswer(sel, el) {
        clearInterval(timer);
        const qData = questions[currentQ];
        const isCorrect = (sel === qData.correct);
        userAnswers.push({ q: qData.q, sel: sel || "تجاوز الوقت", cor: qData.correct, isCorrect, why: qData.why });
        document.querySelectorAll('.option').forEach(o => o.onclick = null);
        if(isCorrect) { score++; if(el) el.classList.add('correct-opt'); } 
        else { if(el) el.classList.add('wrong-opt'); document.querySelectorAll('.option').forEach(o => { if(o.innerText === qData.correct) o.classList.add('correct-opt'); }); }
        const f = document.getElementById('feedback');
        f.innerHTML = `<strong>${isCorrect ? '✅ رائع' : '❌ خطأ'}</strong><br>${qData.why}`;
        f.style.display = 'block';
        document.getElementById('next-btn').classList.remove('hidden');
    }

    function loadNextQuestion() { currentQ++; loadQuestion(); }

    function finishQuiz() {
        document.getElementById('quiz-page').classList.add('hidden');
        document.getElementById('result-page').classList.remove('hidden');
        const name = document.getElementById('studentName').value;
        document.getElementById('score-text').innerHTML = `المتحدي: ${name}<br>النتيجة: ${score} من 38`;
        const sum = document.getElementById('quiz-summary');
        userAnswers.forEach((ans, i) => {
            const d = document.createElement('div');
            d.className = `summary-item ${ans.isCorrect ? 'summary-correct' : 'summary-wrong'}`;
            d.innerHTML = `<b>س${i+1}: ${ans.q}</b><br>إجابتك: ${ans.sel} | الصحيحة: ${ans.cor}<br><small>${ans.why}</small>`;
            sum.appendChild(d);
        });
    }
</script>
</body>
</html>